function [logpsd,freq,ptotal,pmax] = NVD12_log_psd(x,n,ts)

y = zeros(1,n);

h = waitbar(0,'Dang tinh lap trong tinh toan For Loop in PSD Calculation');
for k=1:n
	freq(k) =(k-1-(n/2))/(n*ts);
   y(k) = x(k)*((-1.0)^k);
   waitbar(k/n)
end;
v           = fft(y)/n;
psd         = abs(v).^2;
pmax        = max(psd);
ptotal      = sum(psd);
logpsd      = 10*log10(psd/pmax);
%
% Truncate negative values at -60 dB
%
for k =1:n
	if(logpsd(k)<-60.0)
      logpsd(k) =-60.0;
	end
end
close(h)